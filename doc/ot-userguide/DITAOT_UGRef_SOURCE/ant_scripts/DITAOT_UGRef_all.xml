<?xml version="1.0" encoding="UTF-8" ?>
<!-- (c) Copyright VR Communications, Inc. All Rights Reserved. -->
<!-- Ant script for the DITA Open Toolkit User Guide and Reference (DITAOT_UGRef) -->
<project name="toolkitug" default="xhtml" basedir="c:/ditaot">

  <!-- project global properties -->
  <property name="projdir" value="c:/DITAOT_UGRef_SOURCE"/>
  <property name="outdir" value="c:/DITAOT_UGRef_OUTPUT"/>
  <property name="PHPexe" value="c:/wamp/php/php.exe"/>
  <property name="args.logdir" value="${outdir}"/>
  <property name="MAP_file" value="DITAOT_UGRef.ditamap"/>

  <!-- define path to Java code -->
  <path id="dost.class.path">
    <pathelement location="${basedir}${file.separator}lib${file.separator}dost.jar"/>
  </path>
  
  <!-- define the Ant targets and initialize the processing environment -->
  <taskdef name="integrate" classname="org.dita.dost.platform.IntegratorTask">
    <classpath refid="dost.class.path"/>
  </taskdef>

  <!-- create the default XHTML output and debug cross-reference -->
  <target name="xhtml" depends="integrate, ditadebug, ditalinks, dita2xhtml">
  </target>
  <target name="integrate">
    <integrate ditadir="${basedir}"/>
  </target>
  
  <!-- create all output types -->
  <target name="alltargets" depends="integrate, dita2xhtml, dita2htmlhelp, 
     dita2pdf2, dita2troff, dita2docbook, dita2javahelp, dita2wordrtf, dita2eclipsecontent,
     dita2eclipsehelp, dita2fmxml, dita2pdf">
  </target>
  <!-- handy abbreviation -->
  <target name="all" depends="allreports, alltargets" />
  
  <!-- create all reports -->
  <target name="allreports" depends="ditadebug, ditalinks, ditaauthors, ditaids, ditakeys" />
  
  <!-- create the ditamap debug cross-reference -->
  <target name="ditadebug">
    <echo>Building debugging cross-reference file ditadebug.txt</echo>
    <mkdir dir="${outdir}/debug_files"/>
    <exec executable="${PHPexe}" dir = "${projdir}" output="${outdir}/debug_files/ditadebug.txt">
      <arg value="${projdir}/project/tools/ditadebug.php"/>
      <arg value="${MAP_file}"/>
    </exec>
  </target>

  <!-- create the ditamap URL check -->
  <target name="ditalinks">
    <echo>Building URL check file ditalinks.txt</echo>
    <mkdir dir="${outdir}/debug_files"/>
    <exec executable="${PHPexe}" dir = "${projdir}" output="${outdir}/debug_files/ditalinks.txt">
      <arg value="${projdir}/project/tools/ditalinks.php"/>
      <arg value="${MAP_file}"/>
    </exec>
  </target>

  <!-- create the ditamap author and copyright statistics -->
  <target name="ditaauthors">
    <echo>Building author/copyright file ditaauth.txt</echo>
    <mkdir dir="${outdir}/debug_files"/>
    <exec executable="${PHPexe}" dir = "${projdir}" output="${outdir}/debug_files/ditaauthors.txt">
      <arg value="${projdir}/project/tools/ditaauthors.php"/>
      <arg value="${MAP_file}"/>
    </exec>
  </target>

  <!-- create the ditamap ID listing  -->
  <target name="ditaids">
    <echo>Building ID list file ditaids.txt</echo>
    <mkdir dir="${outdir}/debug_files"/>
    <exec executable="${PHPexe}" dir = "${projdir}" output="${outdir}/debug_files/ditaids.txt">
      <arg value="${projdir}/project/tools/ditaids.php"/>
      <arg value="${MAP_file}"/>
    </exec>
  </target>

  <!-- create the ditamap keyword metadata statistics -->
  <target name="ditakeys">
    <echo>Building keyword metadata file ditakeys.txt</echo>
    <mkdir dir="${outdir}/debug_files"/>
    <exec executable="${PHPexe}" dir = "${projdir}" output="${outdir}/debug_files/ditakeys.txt">
      <arg value="${projdir}/project/tools/ditakeys.php"/>
      <arg value="${MAP_file}"/>
    </exec>
  </target>

  <!-- create xhtml output -->
  <target name="dita2xhtml">
    <ant antfile="${basedir}${file.separator}conductor.xml" target="init">
      <property name="args.input" value="${projdir}/${MAP_file}"/>
      <property name="output.dir" value="${outdir}/xhtml"/>
      <property name="dita.temp.dir" value="${outdir}/temp"/>
      <property name="transtype" value="xhtml"/>
      <property name="args.draft" value="yes"/>
      <property name="args.indexshow" value="yes"/>
      <property name="dita.extname" value=".dita"/>
      <!-- Conditional processing (filtering) by platform (Windows or Linux)
      <property name="dita.input.valfile" value="${projdir}/ditaval_files/platform_filtering.ditaval"/>
      -->
    </ant>
    <!-- copy entire set of garage sample files as DITA files (these should not be processed) -->   
    <!-- <copy todir="${outdir}/garage"> 
      <fileset dir="${projdir}/samples/samplefiles/garage"/>
    </copy> -->
  </target>

  <!-- create htmlhelp output -->
  <target name="dita2htmlhelp">
    <ant antfile="${basedir}${file.separator}conductor.xml" target="init">
      <property name="args.input" value="${projdir}/${MAP_file}"/>
      <property name="output.dir" value="${outdir}/htmlhelp"/>
      <property name="dita.temp.dir" value="${outdir}/temp"/>
      <property name="transtype" value="htmlhelp"/>
      <property name="args.draft" value="yes"/>
      <property name="args.indexshow" value="yes"/>
      <property name="dita.extname" value=".dita"/>
    </ant>
  </target>

  <!-- create pdf output -->
  <target name="dita2pdf">
    <ant antfile="${basedir}${file.separator}conductor.xml" target="init">
      <property name="args.input" value="${projdir}/${MAP_file}"/>
      <property name="output.dir" value="${outdir}/pdf"/>
      <property name="dita.temp.dir" value="${outdir}/temp"/>
      <property name="transtype" value="pdf"/>
      <property name="args.draft" value="yes"/>
      <property name="args.indexshow" value="yes"/>
      <property name="args.xsl" value="${basedir}/xsl/xdita2fo-shell.xsl"/>
      <property name="dita.extname" value=".dita"/>
    </ant>
  </target>

  <!-- create docbook output -->
  <target name="dita2docbook">
    <ant antfile="${basedir}${file.separator}conductor.xml" target="init">
      <property name="args.input" value="${projdir}/${MAP_file}"/>
      <property name="output.dir" value="${outdir}/docbook"/>
      <property name="dita.temp.dir" value="${outdir}/temp"/>
      <property name="transtype" value="docbook"/>
      <property name="args.draft" value="yes"/>
      <property name="args.indexshow" value="yes"/>
      <property name="dita.extname" value=".dita"/>
    </ant>
  </target>

  <!-- create javahelp output -->
  <target name="dita2javahelp">
    <ant antfile="${basedir}${file.separator}conductor.xml" target="init">
      <property name="args.input" value="${projdir}/${MAP_file}"/>
      <property name="output.dir" value="${outdir}/javahelp"/>
      <property name="dita.temp.dir" value="${outdir}/temp"/>
      <property name="transtype" value="javahelp"/>
      <property name="args.draft" value="yes"/>
      <property name="args.indexshow" value="yes"/>
      <property name="dita.extname" value=".dita"/>
    </ant>
  </target>

  <!-- create troff output -->
  <target name="dita2troff">
    <ant antfile="${basedir}${file.separator}conductor.xml" target="init">
      <property name="args.input" value="${projdir}/${MAP_file}"/>
      <property name="output.dir" value="${outdir}/troff"/>
      <property name="dita.temp.dir" value="${outdir}/temp"/>
      <property name="transtype" value="troff"/>
      <property name="args.draft" value="yes"/>
      <property name="args.indexshow" value="yes"/>
      <property name="dita.extname" value=".dita"/>
    </ant>
  </target>

  <!-- create wordrtf output -->
  <target name="dita2wordrtf">
    <ant antfile="${basedir}${file.separator}conductor.xml" target="init">
      <property name="args.input" value="${projdir}/${MAP_file}"/>
      <property name="output.dir" value="${outdir}/wordrtf"/>
      <property name="dita.temp.dir" value="${outdir}/temp"/>
      <property name="transtype" value="wordrtf"/>
      <property name="args.draft" value="yes"/>
      <property name="args.indexshow" value="yes"/>
      <property name="dita.extname" value=".dita"/>
    </ant>
  </target>

  <!-- create eclipsecontent output -->
  <target name="dita2eclipsecontent">
    <ant antfile="${basedir}${file.separator}conductor.xml" target="init">
      <property name="args.input" value="${projdir}/${MAP_file}"/>
      <property name="output.dir" value="${outdir}/eclipsecontent"/>
      <property name="dita.temp.dir" value="${outdir}/temp"/>
      <property name="transtype" value="eclipsecontent"/>
      <property name="args.draft" value="yes"/>
      <property name="args.indexshow" value="yes"/>
      <property name="dita.extname" value=".dita"/>
    </ant>
  </target>

  <!-- create eclipsehelp output -->
  <target name="dita2eclipsehelp">
    <ant antfile="${basedir}${file.separator}conductor.xml" target="init">
      <property name="args.input" value="${projdir}/${MAP_file}"/>
      <property name="output.dir" value="${outdir}/eclipsehelp"/>
      <property name="dita.temp.dir" value="${outdir}/temp"/>
      <property name="transtype" value="eclipsehelp"/>
      <property name="args.draft" value="yes"/>
      <property name="args.indexshow" value="yes"/>
      <property name="dita.extname" value=".dita"/>
    </ant>
  </target>

  <!-- create FrameMaker Adapter output -->
  <target name="dita2fmxml">
    <ant antfile="${basedir}${file.separator}conductor.xml" target="init">
      <property name="args.input" value="${projdir}/${MAP_file}"/>
      <property name="output.dir" value="${outdir}/fmxml"/>
      <property name="dita.temp.dir" value="${outdir}/temp"/>
      <property name="transtype" value="fmxml"/>
      <property name="dita.extname" value=".dita"/>
    </ant>
  </target>

  <!-- create Idiom FO output -->
  <target name="dita2pdf2">
    <ant antfile="${basedir}${file.separator}conductor.xml" target="init">
      <property name="args.input" value="${projdir}/${MAP_file}"/>
      <property name="output.dir" value="${outdir}/pdf2"/>
      <property name="dita.temp.dir" value="${outdir}/temp"/>
      <property name="transtype" value="pdf2"/>
      <property name="args.draft" value="yes"/>
      <property name="args.indexshow" value="yes"/>
      <property name="dita.extname" value=".dita"/>
    </ant>
  </target>

</project>
